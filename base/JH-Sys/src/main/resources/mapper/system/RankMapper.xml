<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jh.system.mapping.IRankMapper" >
  <resultMap id="BaseResultMap" type="com.jh.system.entity.InitRank" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="rank_id" property="rankId" jdbcType="BIGINT" />
    <result column="data_status" property="dataStatus" jdbcType="CHAR" />
    <result column="del_flag" property="delFlag" jdbcType="CHAR" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    <result column="creator_name" property="creatorName" jdbcType="VARCHAR" />
    <result column="creator" property="creator" jdbcType="INTEGER" />
    <result column="modify_time" property="modifyTime" jdbcType="TIMESTAMP" />
    <result column="modifier_name" property="modifierName" jdbcType="VARCHAR" />
    <result column="modifier" property="modifier" jdbcType="INTEGER" />
    <result column="remark" property="remark" jdbcType="VARCHAR" />
    <result column="rank_code" property="rankCode" jdbcType="VARCHAR" />
    <result column="rank_name" property="rankName" jdbcType="VARCHAR" />
    <result column="china_name" property="chinaName" jdbcType="VARCHAR" />
    <result column="level" property="level" jdbcType="INTEGER" />
    <result column="parent_id" property="parentId" jdbcType="BIGINT" />
    <result column="area" property="area" jdbcType="NUMERIC" />
    <result column="lon" property="lon" jdbcType="NUMERIC" />
    <result column="lat" property="lat" jdbcType="NUMERIC" />
    <result column="bbox" property="bbox" jdbcType="OTHER" />
    <result column="vertex_bbox" property="vertexBbox" jdbcType="OTHER" />
    <result column="strip_number" property="stripNumber" jdbcType="VARCHAR" />
    <result column="centroid" property="centroid" jdbcType="OTHER" />
<!--    <result column="crop_id" property="cropId" jdbcType="INTEGER" />-->
  </resultMap>

  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    rank_id, data_status, del_flag, create_time, creator_name, creator, modify_time, 
    modifier_name, modifier, remark, rank_code, rank_name, china_name, level, parent_id, 
    area, lon, lat, bbox, vertex_bbox, strip_number, centroid, crop_id
  </sql>

 <select id="queryRegionRankStatistics" parameterType="java.lang.Long" resultType="com.jh.system.model.RankParam">
   SELECT DISTINCT
        ( parent_id ) AS parentId,
        count( 0 ) AS rankNum,
        sum( area ) AS areaSum
    FROM
        init_rank
    WHERE
        parent_id IN ( SELECT region_id FROM init_region WHERE parent_id = #{parentId,jdbcType=BIGINT} )
    GROUP BY
        parent_id
 </select>

<!--根据条件查询地块分布数据的时间点集合-->
    <select id="findRankTimes" resultType="java.lang.String" parameterType="com.jh.system.model.RankParam" >
        SELECT DISTINCT
        ( data_time )
        FROM
        init_rank
        WHERE
        del_flag = '1'
        AND data_status = '1'
        AND parent_id IN ( SELECT region_id FROM init_region WHERE parent_id = #{parentId,jdbcType=BIGINT} )
        order by data_time asc
  </select>
</mapper>